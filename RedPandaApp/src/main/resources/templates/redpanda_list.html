<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head th:replace="_layout :: head(~{::title})">
  <title>西山公園レッサーパンダ図鑑</title>
</head>
<body>
<main th:replace="_layout :: layout(~{::content})">
  <div th:fragment="content">

    <div class="d-flex align-items-center mb-3">
      <h1 class="h4 mb-0">レッサーパンダ図鑑</h1>
      <span class="badge rp-badge ms-2" th:text="${totalCount} + ' 件'"></span>
      <a class="btn btn-sm btn-primary ms-auto" th:href="@{/posts/new}">新規投稿</a>
    </div>

    <form class="row g-2 mb-3" th:action="@{/redpandas}" method="get">
      <div class="col-sm-6 col-md-4">
        <input class="form-control" type="text" name="q" th:value="${q}" placeholder="名前・親・特徴で検索">
      </div>
      <input type="hidden" name="size" th:value="${size}">
      <div class="col-auto">
        <button class="btn btn-primary" type="submit">検索</button>
      </div>
    </form>

    <div class="card p-2">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
          <tr>
            <th>名前</th>
            <th>性別</th>
            <th>生年月日</th>
            <th>死亡日</th>
            <th>他園移動日</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="p : ${pandaList}">
            <td>
              <a th:href="@{/redpandas/{name}(name=${p.name})}"
                 class="link-primary" th:text="${p.name}"></a>
            </td>
            <td th:text="${p.gender}"></td>
            <td th:text="${p.birthDate}"></td>
            <td th:text="${p.deathDate}"></td>
            <td th:text="${p.movedOutDate}"></td>
          </tr>
          <tr th:if="${#lists.isEmpty(pandaList)}">
            <td colspan="5" class="text-center text-muted py-4">該当データがありません</td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ページャ（最初/前/次/最後） -->
    <nav class="d-flex justify-content-center mt-3" th:if="${totalPages > 1}">
      <ul class="pagination pagination-sm mb-0">
        <li class="page-item" th:classappend="${page == 0} ? 'disabled'">
          <a class="page-link" th:href="@{/redpandas(page=${0}, size=${size}, q=${q})}">最初</a>
        </li>
        <li class="page-item" th:classappend="${page == 0} ? 'disabled'">
          <a class="page-link" th:href="@{/redpandas(page=${page-1}, size=${size}, q=${q})}">前へ</a>
        </li>
        <li class="page-item disabled">
          <span class="page-link" th:text="${page+1} + ' / ' + ${totalPages}"></span>
        </li>
        <li class="page-item" th:classappend="${page+1 >= totalPages} ? 'disabled'">
          <a class="page-link" th:href="@{/redpandas(page=${page+1}, size=${size}, q=${q})}">次へ</a>
        </li>
        <li class="page-item" th:classappend="${page+1 >= totalPages} ? 'disabled'">
          <a class="page-link" th:href="@{/redpandas(page=${totalPages-1}, size=${size}, q=${q})}">最後</a>
        </li>
      </ul>
    </nav>

  </div>
</main>
</body>
</html>
